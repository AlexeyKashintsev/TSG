Select t1.flat_id, sum(t1.payment_sum) as paySum
From opl_payments t1
 Where :flatID = t1.flat_id
 and :beg_date < t1.payment_date
 and (:end_date >= t1.payment_date or CAST(:end_date AS DATE) is null)
group by t1.flat_id